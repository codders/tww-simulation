import { ColdCostGenerator } from "./costs";
import { sanierung, Sanierung } from "./sanierung";
import { basisParametersBase, sanierung20230119, variants20230119 } from "./variantHistory";

test("Kaltmiete Variant 3 - 20230119", () => {
    const costs = new ColdCostGenerator(sanierung20230119)
    costs.setDirektKredite(700000)
    costs.setDirektKreditZinsen(1.2)
    costs.setKfwKreditZinsen(1.22)
    expect(costs.getSparkasseTilgungAmount().toFixed(2)).toBe("32000.00")
    expect(costs.getSparkasseZinsenAmount().toFixed(2)).toBe("8500.00")
    expect(costs.getKfwTilgungsSumme(3).toFixed(2)).toBe("478301.56")
    expect(costs.getKfwTilgungPayment(3).toFixed(2)).toBe("13775.09")
    expect(costs.getDkTilgungAmount(3).toFixed(2)).toBe("4620.00")
    expect(costs.getFinancingCosts(3).toFixed(2)).toBe("83210.36")
    expect(costs.getKaltMiete(3).toFixed(2)).toBe("11.46")
})

test("Kaltmiete Variant 3 - 20230125", () => {
    const costs = new ColdCostGenerator(new Sanierung(basisParametersBase, variants20230119))
    costs.setDirektKredite(400000)
    costs.setKfwKreditZinsen(1.49)
    expect(costs.getSparkasseTilgungAmount().toFixed(2)).toBe("32000.00")
    expect(costs.getSparkasseZinsenAmount().toFixed(2)).toBe("8500.00")
    expect(costs.getDkTilgungAmount(3).toFixed(2)).toBe("3720.00")
    expect(costs.getFinancingCosts(3).toFixed(2)).toBe("89320.78")
    expect(costs.getKaltMiete(3).toFixed(2)).toBe("12.23")
})

test("Kaltmiete Variant 4 - 20230119", () => {
    const costs = new ColdCostGenerator(sanierung20230119)
    costs.setDirektKredite(700000)
    costs.setDirektKreditZinsen(1.2)
    costs.setKfwKreditZinsen(1.22)
    expect(costs.getKaltMiete(4).toFixed(2)).toBe("11.32")
})

test("Kaltmiete Variant 4 - 20230404", () => {
    const costs = new ColdCostGenerator(sanierung, 0)
    costs.setDirektKredite(400000)
    costs.setDirektKreditZinsen(1.0)
    costs.setDirektKreditTilgung(0.3)
    expect(costs.getFinancingCosts(4).toFixed(2)).toBe("98883.68")
    expect(costs.sanierung.getInstandhaltungsKosten().toFixed(2)).toBe("6810.00")
    expect(costs.sanierung.getVerwaltungsKosten().toFixed(2)).toBe("2043.00")
    expect(costs.sanierung.getSolidarbeitrag().toFixed(2)).toBe("817.20")
    expect(costs.getMietausfallwagnis(4).toFixed(2)).toBe("3357.34")
    expect(costs.getTotalCosts(4).toFixed(2)).toBe("111911.21")
    expect(costs.getKaltMiete(4).toFixed(2)).toBe("13.69")
})

test("Kaltmiete Variant 4 with Tilgungszuschuss - 20230404", () => {
    const costs = new ColdCostGenerator(sanierung, 0.25, 40000)
    costs.setDirektKredite(400000)
    costs.setDirektKreditZinsen(1.0)
    costs.setDirektKreditTilgung(0.3)
    expect(costs.getKfwTilgungsSumme(4).toFixed(2)).toBe("789107.13")
    expect(costs.getSparkasseTilgungAmount().toFixed(2)).toBe("32000.00")
    expect(costs.getSparkasseZinsenAmount().toFixed(2)).toBe("8500.00")
    expect(costs.getDkTilgungAmount(4).toFixed(2)).toBe("3613.40")
    expect(costs.getDkZinsenAmount(4).toFixed(2)).toBe("12044.68")
    expect(costs.getKfwTilgungPayment(4).toFixed(2)).toBe("22726.29")
    expect(costs.getFinancingCosts(4).toFixed(2)).toBe("87801.28")
    expect(costs.sanierung.getInstandhaltungsKosten().toFixed(2)).toBe("6810.00")
    expect(costs.sanierung.getVerwaltungsKosten().toFixed(2)).toBe("2043.00")
    expect(costs.sanierung.getSolidarbeitrag().toFixed(2)).toBe("817.20")
    expect(costs.getMietausfallwagnis(4).toFixed(2)).toBe("3014.58")
    expect(costs.getTotalCosts(4).toFixed(2)).toBe("100486.06")
    expect(costs.getKaltMiete(4).toFixed(2)).toBe("12.30")
})